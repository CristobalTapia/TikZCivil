%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%* file tikzcivil.sty
%*
%*
%*  Author: Crist√≥bal Tapia
%*  crtapia at gmail dot com
%*
%*  This program is free software; you can redistribute it and/or modify
%*  it under the terms of the GNU General Public License as published by
%*  the Free Software Foundation; either version 2 of the License, or
%*  (at your option) any later version.
%*
%*  This program is distributed in the hope that it will be useful,
%*  but WITHOUT ANY WARRANTY; without even the implied warranty of
%*  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
%*  GNU General Public License for more details.
%*
%*  You should have received a copy of the GNU General Public License
%*  along with this program; if not, write to the Free Software
%*  Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307 USA
%*
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%Here are defined all kind of drawing, that are useful for the Structural Analysis.
\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{tikzcivil}[2014/04/13 StructuralAnalysis Package]
\RequirePackage{tikz}
\def\packagename{tikzcivil}
\RequirePackage{fp}
%
%Here are the tikz options that are going to be used in this package.
\usetikzlibrary{calc,arrows,shapes,positioning,
                shadows,trees,patterns,decorations.pathmorphing,
                decorations.markings
}
\tikzset{
  ground/.style={draw=black,text width=10em,line width=0.1em,pattern = north east lines},
  soil style/.style={draw=none,line width=1pt, color=white, fill,
    minimum width=3cm,minimum height=0.3cm,inner sep=0pt,
    pattern = north east lines, preaction={drop shadow={opacity=0}},
    },
  column/.style={color=black, line width=0.1em},
  spring/.style={color=black,decoration={aspect=0.3, segment length=\separation,
      amplitude=0.5em,coil},
    decorate},
  line wall/.style={color=black, line width=1pt, fill=white},
  line normal/.style={color=black, line width=1pt},
  thrust/.style={triangle 90 cap, line width=2pt},
  frame element/.style={color=black, line width=2pt},
  flecha/.style={thick,<->},
  damper/.style={thick,decoration={markings,
    mark connection node=dmp,
    mark=at position 0.5 with
    {
      \node (dmp) [thick,inner sep=0pt,transform shape,rotate=-90,minimum width=11pt,minimum height=3pt,draw=none] {};
      \draw [thick] ($(dmp.north east)+(2pt,0)$) -- (dmp.south east) -- (dmp.south west) -- ($(dmp.north west)+(2pt,0)$);
      \draw [thick] ($(dmp.north)+(0,-3pt)$) -- ($(dmp.north)+(0,3pt)$);
    }
  }, decorate},
}
%Define style for the dimensions
\tikzset{
  dim above/.style={to path={\pgfextra{
        \pgfinterruptpath
        \draw[>=latex,|<->|] let
        \p1=($(\tikztostart)!2mm!90:(\tikztotarget)$),
        \p2=($(\tikztotarget)!2mm!-90:(\tikztostart)$)
        in(\p1) -- (\p2) node[pos=.5,sloped,above]{#1};
        \endpgfinterruptpath
      }\tikztonodes
    }
  },
  dim below/.style={to path={\pgfextra{
        \pgfinterruptpath
        \draw[>=latex,|<->|] let 
        \p1=($(\tikztostart)!2mm!90:(\tikztotarget)$),
        \p2=($(\tikztotarget)!2mm!-90:(\tikztostart)$)
        in (\p1) -- (\p2) node[pos=.5,sloped,below]{#1};
        \endpgfinterruptpath
      }\tikztonodes
    }
  },
}
%Calculate angle between two coordinates
% #1: name of the variable wher the value will be stored
% #2: coordinate 1
% #3: coordinate 2
\newcommand{\pgfextractangle}[3]{%
    \pgfmathanglebetweenpoints{\pgfpointanchor{#2}{center}}
                              {\pgfpointanchor{#3}{center}}
    \global\let#1\pgfmathresult
}

%--------------- Read files ---------------------------------------------------%
%The files where the commands are defined are included
%------------------------------------------------------------------------------%
\input tikzcivil-geomechanics.tex
\input tikzcivil-structural.tex

\endinput
